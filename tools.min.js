var _=function(){var t={build:function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},serialize:function(t){var n="";for(var e in t)t[e]="object"==typeof t[e]?JSON.stringify(t[e]):t[e],t[e]=encodeURI(t[e]),n+=e+"="+t[e]+"&";return n.slice(0,n.length-1)}},n=function(e){var r={};r.sel=function(){if("string"==typeof e){var t=document.querySelectorAll(e);return Array.prototype.slice.call(t)}if(e instanceof HTMLElement)return[e];if(Array.isArray(e))return e;throw"Error. This is not a proper selector type."}(),r.loop=function(t){for(var n=0;n<r.sel.length;n++)t(r.sel[n],n)},r.first=function(){return r.sel[0]};var i={addClass:function(t){var n=r.first().className.split(/ /);return-1===n.indexOf(t)&&n.push(t),r.first().className=n.join(" "),this},append:function(t){if(!(t instanceof HTMLElement))throw"Error. This is not a proper HTML Node type.";return r.first().appendChild(t),this},attr:function(t,n){return n?(r.loop(function(e){e.setAttribute(t,n)}),this):r.first().getAttribute(t)},children:function(t){var e=n(t),i=[];return e.forEach(function(t){for(var n=t;t;)if(n=n.parentNode,n.isSameNode(r.first())){i.push(t);break}}),n(i)},css:function(t,n){return"object"==typeof t?r.loop(function(n,e){for(var r in t)t.hasOwnProperty(r)&&(n.style[r]=t[r])}):typeof t==typeof n&&r.loop(function(e,r){e.style[t]=n}),this},each:function(t){return r.loop(function(n,e){t.call(n,e)}),this},el:function(t){if("function"==typeof t){var e=r.sel.filter(function(n,e){return t.call(n,n,e)});return n(e)}if("number"==typeof t){if(r.sel[t])return n(r.sel[t]);throw"This element index does not exist."}throw"Error. Please use a callback function or select and index."},html:function(t,n){return t?(r.loop(function(e){e.innerHTML=n?e.innerHTML+t:t}),this):r.first().innerHTML},on:function(t,n){return r.loop(function(e){e.addEventListener(t,function(t){n.call(t.target)})}),this},parent:function(){return n(r.first().parentNode)},remove:function(){var t=r.first();return t.parentNode.removeChild(t),r.sel.shift(),n(r.sel)},removeClass:function(t){var n=r.first().className.split(/ /),e=n.indexOf(t);return e>-1&&n.splice(e,1),r.first().className=n.join(" "),this},text:function(t,n){return"undefined"==typeof html||null===html||0===html.length?r.first().innerText:(r.loop(function(t){t.innerText=n?t.innerText+html:t.innerText}),this)},val:function(t){return t?(r.loop(function(n){n.value=t}),this):r.first().value}},o=r.sel;return t.build(o,i),o},e={ajax:function(n){var e=new XMLHttpRequest,r=t.serialize(n.data);"get"==n.type.toLowerCase()&&r&&(n.url+="?"+r),e.open(n.type,n.url,!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(r),e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t,r;try{r="json"===n.dataType.toLowerCase()?JSON.parse(e.response):e.response}catch(i){t=i}n.callback(r,t)}}},create:function(t){t||(t={});var n=document.createElement(t.tagName||"div");for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);for(e in t.style)t.style.hasOwnProperty(e)&&(n.style[e]=t.style[e]);return n},get:function(t,e){n.ajax({type:"GET",url:t,callback:e})},finance:{assetReturn:function(t,n,e){return Math.pow(n/t,1/e)-1},futureValue:function(t,n,e){var r=Math.pow(n+1,e);return t*r},mortgagePayment:function(t,n,e){return n/=12,e*=12,t*n/(1-Math.pow(1+n,-e))},sharpeRatio:function(t,n,e){return(t-n)/e},capm:function(t,n,e){return t+n*(e-t)},expectedValue:function(t,n){var e=0;if(t.length!==n.length)throw"Error. Arrays should be the same length.";return t.forEach(function(t,r){e+=t*n[r]}),e}},quant:{sum:function(t){return t.reduce(function(t,n){return t+n})},mean:function(t){return this.sum(t)/t.length},variance:function(t,n){var e=this.mean(t),r=t.map(function(t){return Math.pow(t-e,2)});return this.sum(r)/(t.length-!!n)},last:function(t){return t[t.length-1]},standardDeviation:function(t,n){var e=this.variance(t,n);return Math.sqrt(e)},kurtosis:function(t){var n=1/t.length,e=this.mean(t),r=this.sum(t.map(function(t){return Math.pow(t-e,4)})),i=Math.pow(this.standardDeviation(t),4);return n*(r/i)},skewness:function(t){var n=t.length,e=this.mean(t),r=this.sum(t.map(function(t){return Math.pow(t-e,3)})),i=(n-1)*Math.pow(this.standardDeviation(t,!0),3);return r/i},movingSample:function(t,n,e){for(var r=t.slice(0,n),i=[],o=n;o<t.length;o++)i[o]=e.call(this,r,t[o]),r.shift(),r.push(t[o]);return i},productSample:function(t,n){for(var e=[],r=1;r<t.length;r++)e[r]=n(t[r],t[r-1]);return e},bollingerBands:function(t,n,e){return this.movingSample(t,n,function(t,n){var r=this.standardDeviation(t,!0),i=this.mean(t);return{high:i+r*(e||1),current:n,low:i-r*(e||1)}})},simpleMovingAverage:function(t,n){return this.movingSample(t,n,function(t){return this.mean(t)})},rollingVolatility:function(t,n){return this.movingSample(t,n,function(t){return 15.84*this.standardDeviation(t,!0)})},rollingSkewness:function(t,n){return this.movingSample(t,n,function(t){return this.skewness(t)})},rollingKurtosis:function(t,n){return this.movingSample(t,n,function(t){return this.kurtosis(t)})},residuals:function(t){return this.productSample(t,function(t,n){return t/n})},gaussian:function(){var t,n,e;do t=2*Math.random()-1,n=2*Math.random()-1,e=t*t+n*n;while(e>=1||0===e);return Math.sqrt(-2*Math.log(e)/e)*t},normalDist:function(t,n){return t+this.gaussian()*n}}};return t.build(n,e),n}();
